# 使用指南

## 快速开始

### 1. 启动应用

在 Visual Studio 2022 中：
- 打开 `MealRecommendationSystem.sln`
- 按 F5 或点击"本地Windows调试器"
- 程序将自动打开浏览器并访问 http://localhost:8000

### 2. 首次使用 - 注册账号

打开应用后，您会看到登录/注册页面：

#### 注册步骤：
1. 点击"注册"标签
2. 填写以下信息：
   - **用户名**：您的用户名（必填）
   - **密码**：您的密码（必填）
   - **年龄**：您的年龄（例如：25）
   - **性别**：选择"男"或"女"
   - **体重**：您的体重，单位kg（例如：70.5）
   - **身高**：您的身高，单位cm（例如：175）
   - **活动水平**：选择您的日常活动水平
     - 久坐：办公室工作，很少运动
     - 轻度活动：每周运动1-3天
     - 中度活动：每周运动3-5天
     - 高强度活动：每周运动6-7天
     - 极高强度：每天高强度运动或体力劳动
3. 点击"注册"按钮
4. 系统会自动计算您的每日营养目标并登录

### 3. 登录

如果您已有账号：
1. 在"登录"标签下
2. 输入用户名和密码
3. 点击"登录"按钮

## 主要功能

### 📊 仪表盘

登录后的首页显示：
- **每日热量目标**：根据您的身体数据和活动水平计算
- **蛋白质目标**：每日需要摄入的蛋白质克数
- **碳水化合物目标**：每日需要摄入的碳水化合物克数
- **脂肪目标**：每日需要摄入的脂肪克数

快速操作按钮：
- **生成今日推荐**：快速跳转到推荐页面
- **查看历史记录**：查看您的历史餐单
- **浏览食物库**：浏览所有可用食物

### 👤 个人信息

在这里您可以：
- 查看当前的个人信息
- 修改年龄、体重、身高
- 更新性别和活动水平
- 点击"保存更改"按钮更新信息
- 系统会自动重新计算营养目标

### ✨ 智能推荐

这是系统的核心功能：

#### 生成推荐步骤：
1. 点击左侧菜单的"智能推荐"
2. 选择日期（默认为今天）
3. 点击"生成推荐"按钮
4. 系统会生成三餐推荐：
   - 🌅 早餐
   - ☀️ 午餐
   - 🌙 晚餐

#### 推荐详情显示：
- 每餐的热量、蛋白质、碳水、脂肪含量
- 包含的食物列表
- 每日营养总计
- 与您的目标的对比百分比

#### 保存推荐：
- 如果满意当前推荐，点击"💾 保存此推荐"
- 推荐将保存到历史记录中
- 可以在"历史餐单"中查看

### 📜 历史餐单

查看和管理您的餐单历史：

#### 功能：
- 按日期分组显示所有历史餐单
- 显示每日的三餐详情
- 查看每日营养总计
- 显示目标完成度百分比
- 最新的记录显示在最前面

#### 信息展示：
- 每餐的详细食物组成
- 每餐的营养数据
- 每日总热量、总蛋白质、总碳水、总脂肪
- 与目标的对比（百分比显示）

### 🥗 食物库

浏览和搜索系统中的所有食物：

#### 搜索功能：
- 在搜索框输入食物名称或标签
- 实时过滤显示匹配的食物

#### 筛选功能：
- 使用类别下拉菜单按类别筛选
- 类别包括：主食、蔬菜、水果、肉类、奶制品等

#### 食物信息：
每个食物卡片显示：
- 食物名称
- 所属类别
- 热量（kcal）
- 蛋白质（g）
- 碳水化合物（g）
- 脂肪（g）
- 相关标签（如：高蛋白、低脂、富含纤维等）

## 界面特点

### 🎨 设计亮点
- **渐变背景动画**：背景色彩会缓慢变化，提供舒适的视觉体验
- **流畅动画**：所有界面切换都有平滑的过渡动画
- **卡片式布局**：信息以清晰的卡片形式展示
- **图标标识**：使用emoji图标，直观易懂
- **响应式设计**：支持不同屏幕尺寸

### 🎯 用户体验
- **自动保存**：数据自动保存到本地文件
- **会话管理**：登录后无需重复登录（除非退出）
- **实时反馈**：操作成功/失败会有提示消息
- **加载动画**：请求处理时显示加载动画

### 📱 移动端适配
- 在小屏幕上，侧边栏会变为横向滚动
- 卡片自动调整为单列布局
- 按钮和输入框适配触摸操作

## 营养目标计算说明

系统使用 **Mifflin-St Jeor 公式** 计算基础代谢率(BMR)：

### 男性：
```
BMR = 10 × 体重(kg) + 6.25 × 身高(cm) - 5 × 年龄 + 5
```

### 女性：
```
BMR = 10 × 体重(kg) + 6.25 × 身高(cm) - 5 × 年龄 - 161
```

### 总热量需求 (TDEE)：
```
TDEE = BMR × 活动系数
```

活动系数：
- 久坐：1.2
- 轻度活动：1.375
- 中度活动：1.55
- 高强度活动：1.725
- 极高强度：1.9

### 营养素分配：
- **蛋白质**：总热量的 30%（每克4卡路里）
- **碳水化合物**：总热量的 40%（每克4卡路里）
- **脂肪**：总热量的 30%（每克9卡路里）

## 推荐算法说明

系统使用智能算法为您推荐餐单：

### 推荐原则：
1. **营养均衡**：确保三大营养素比例合理
2. **热量控制**：总热量接近目标值
3. **食物多样性**：避免重复，增加多样性
4. **用户偏好**：考虑过敏原等个人因素
5. **餐次适配**：
   - 早餐：30% 热量，偏向碳水
   - 午餐：40% 热量，均衡营养
   - 晚餐：30% 热量，偏向蛋白质

### 评分系统：
算法会对每种食物进行评分，考虑：
- 营养完整度
- 与目标的匹配度
- 食物类别适配性
- 历史选择频率

## 数据管理

### 数据存储位置
所有数据保存在 `data` 目录下：
- `users.txt` - 用户信息
- `foods.txt` - 食物数据库
- `meals.txt` - 餐单历史

### 数据格式
数据以文本格式存储，便于备份和迁移。

### 备份建议
定期备份 `data` 目录以防数据丢失。

## 常见问题

### Q: 如何修改端口号？
A: 在 `src/main.cpp` 中修改 `WebServer server(8000, "www");` 中的端口号。

### Q: 忘记密码怎么办？
A: 可以编辑 `data/users.txt` 文件手动修改密码。

### Q: 如何添加自定义食物？
A: 可以编辑 `data/foods.txt` 文件添加新的食物条目。

### Q: 推荐不满意怎么办？
A: 可以多次点击"生成推荐"，系统会生成不同的推荐方案。

### Q: 调试时如何查看程序的命令行输出？
A:
- **Visual Studio 2022（推荐）**：按 **F5** 运行后会出现一个控制台窗口，里面会打印服务器启动信息、请求日志等。
  - 如果你看不到控制台窗口，请检查是否被浏览器窗口遮挡（Alt+Tab 切换）。
  - 也可以用 **Ctrl+F5（开始执行(不调试)）**，这样程序结束后控制台不会立刻关闭，方便查看输出。
- **命令行启动**：在 `bin\x64\Debug\`（或 `bin\x64\Release\`）下用 `cmd/PowerShell` 运行 exe，也能看到完整命令行输出。

### Q: 如何停止服务器？
A: 在控制台窗口按 Ctrl+C，或直接关闭程序。

## 技术支持

如有问题或建议，请查看 `README.md` 了解更多技术细节。

---

祝您使用愉快！🎉
